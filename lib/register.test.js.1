const { Identity } = require('../models/identity')
const { Authentication } = require('../models/authentication')
const { Token } = require('../models/token')
const mongoose = Identity.base

const { register } = require('./register')


beforeAll(() => {
  return Promise.all([
    Identity.deleteMany({}),
    Authentication.deleteMany({}),
    Token.deleteMany({})
  ])
})

afterAll(() => {
  mongoose.connection.close()
})


describe('lib', () => {
  describe('register.js', () => {
    describe('register()', () => {
      
      jest.setTimeout(20000)

      // #1
      test('username:password', done => {
        const username = 'v4ex'
        const password = 'v4ex.com'
        register(username, password, (err, authentication) => {
          console.log(`authentication`, authentication)
          done()
        })
      })

    })
  })
})
